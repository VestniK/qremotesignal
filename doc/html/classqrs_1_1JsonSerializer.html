<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>QRemoteSignal: qrs::JsonSerializer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceqrs.html">qrs</a>::<a class="el" href="classqrs_1_1JsonSerializer.html">JsonSerializer</a>
  </div>
</div>
<div class="contents">
<h1>qrs::JsonSerializer Class Reference</h1><!-- doxytag: class="qrs::JsonSerializer" --><!-- doxytag: inherits="qrs::AbsMessageSerializer" -->
<p><a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> serializer for simple JSON based remote call protocol.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="jsonserializer_8h_source.html">jsonserializer.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for qrs::JsonSerializer:</div>
<div class="dynsection">
 <div class="center">
  <img src="classqrs_1_1JsonSerializer.png" usemap="#qrs::JsonSerializer_map" alt=""/>
  <map id="qrs::JsonSerializer_map" name="qrs::JsonSerializer_map">
<area href="classqrs_1_1AbsMessageSerializer.html" alt="qrs::AbsMessageSerializer" shape="rect" coords="0,0,162,24"/>
</map>
 </div>
</div>

<p><a href="classqrs_1_1JsonSerializer-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acaa2486cd4f6d289b1a703ea11385cc6"></a><!-- doxytag: member="qrs::JsonSerializer::JsonSerializer" ref="acaa2486cd4f6d289b1a703ea11385cc6" args="(QObject *parent=0)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>JsonSerializer</b> (QObject *parent=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aad3e0295ab6ee2b52d0e4cf9a41d7bcb"></a><!-- doxytag: member="qrs::JsonSerializer::JsonSerializer" ref="aad3e0295ab6ee2b52d0e4cf9a41d7bcb" args="(int version, QObject *parent=0)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>JsonSerializer</b> (int version, QObject *parent=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual QByteArray&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classqrs_1_1JsonSerializer.html#a62711f539347e689d2e8def70fde3f1c">serialize</a> (const <a class="el" href="classqrs_1_1Message.html">Message</a> &amp;msg)  throw (UnsupportedTypeException)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual MessageAP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classqrs_1_1JsonSerializer.html#ad813751af9ab056a482bbc3d5e7802a3">deserialize</a> (const QByteArray &amp;msg)  throw (MessageParsingException)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> serializer for simple JSON based remote call protocol. </p>
<p>This class serializes internal library message representation to a simple JSON based protocol message. You can get pointer to single global instance of this class with jsonSerializer macro.</p>
<p>Top level element of JSON object can be <b>RemoteCall</b> or <b>Error</b> it contains child JSON object with detailed information about slot to be called or about error.</p>
<h2><a class="anchor" id="RemoteCall">
Remote call JSON representation.</a></h2>
<p>Remote call message contains the following elements in the child JSON object: </p>
<ul>
<li><b>service</b> element containing string with destination service name. </li>
<li><b>method</b> element containing string with destination slot name. </li>
<li><b>params</b> element containing map of slot parameters. Each parameterhas a name which is stored as a key in this map.</li>
</ul>
<p>Here is an example of a remote call message: </p>
<div class="fragment"><pre class="fragment"> {
    <span class="stringliteral">&quot;RemoteCall&quot;</span> : {
       <span class="stringliteral">&quot;service&quot;</span> : <span class="stringliteral">&quot;Example&quot;</span> ,
       <span class="stringliteral">&quot;method&quot;</span> : <span class="stringliteral">&quot;foo&quot;</span> ,
       <span class="stringliteral">&quot;params&quot;</span> : {
          <span class="stringliteral">&quot;num&quot;</span> : 128
       }
    }
 }
</pre></div><p> This message is request to call slot <b>foo</b> in the <b>Example</b> service with single parameters' <b>num</b> value 128.</p>
<p>There is no information about parameter type and if it is possible to convert parameters' value to the required type then no error will occure during processing this message. For example if service <b>Example</b> has a slot <b>foo</b> with the following definition: </p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> foo(<span class="keyword">const</span> QString &amp;num);
</pre></div><p> then value in the JSON message will be converted to string "128".</p>
<p>Conversations of values are done by convertor functions: </p>
<div class="fragment"><pre class="fragment"> QVariant qrs::createArg(<span class="keyword">const</span> YourType &amp;val);
 <span class="keywordtype">bool</span> qrs::getArgValue(<span class="keyword">const</span> QVariant &amp;arg, YourType&amp; res);
</pre></div><p> You can find more information about them in the <a class="el" href="converters.html">Types that can be used as remote callable slots arguments</a> article.</p>
<h2><a class="anchor" id="Error">
Error message JSON representation.</a></h2>
<p>Error message contains the following elements in the child JSON object: </p>
<ul>
<li><b>errorCode</b> element containing integer code of error. Possible values are listed in the <a class="el" href="classqrs_1_1Message.html#a74c5f8f972118a58c06445bbd371f117">Message::ErrorType</a> enum. </li>
<li><b>description</b> element containing human readable error description. </li>
<li>Optional <b>service</b> element containing the name of a service where error occured. For example error message with this element may be returned in responce on remote call of slot in some service if destination service doesn't contain requested slot. </li>
<li>Optional <b>method</b> element with the name of a method where error occured. Error message can contain this element only if it also contains <b>service</b> element.</li>
</ul>
<p>Here is example of error message JSON representation: </p>
<div class="fragment"><pre class="fragment"> {
    <span class="stringliteral">&quot;Error&quot;</span> : {
       <span class="stringliteral">&quot;errorCode&quot;</span> : 4,
       <span class="stringliteral">&quot;description&quot;</span> : <span class="stringliteral">&quot;Unknown method wrong&quot;</span>,
       <span class="stringliteral">&quot;service&quot;</span> : <span class="stringliteral">&quot;Example&quot;</span>,
       <span class="stringliteral">&quot;method&quot;</span> : <span class="stringliteral">&quot;wrong&quot;</span>
    }
 }
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>JSON object representing error generated by this serializer always contains <b>service</b> and <b>method</b> elements even if they are not specified they contains empty strings. However this serializer can understand error messages without optional elements so there is no need to specify them if you want to call slot in application which is using this serializer for remote calls from application which is not using QRemoteSignal library. </dd></dl>

<p>Definition at line <a class="el" href="jsonserializer_8h_source.html#l00101">101</a> of file <a class="el" href="jsonserializer_8h_source.html">jsonserializer.h</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ad813751af9ab056a482bbc3d5e7802a3"></a><!-- doxytag: member="qrs::JsonSerializer::deserialize" ref="ad813751af9ab056a482bbc3d5e7802a3" args="(const QByteArray &amp;msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MessageAP JsonSerializer::deserialize </td>
          <td>(</td>
          <td class="paramtype">const QByteArray &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throw (<a class="el" href="classqrs_1_1MessageParsingException.html">MessageParsingException</a>)<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Deserealize <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a>. <dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classqrs_1_1MessageParsingException.html" title="Error during message parsing exception.">MessageParsingException</a></em>&nbsp;</td><td>in case of error during message parsing</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>underlying protocol raw message to be converted to a <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> class instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> class instance</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a13461e3103e4110226ec17da52417410" title="Serealize Message.">serialize</a> </dd></dl>
 </p>

<p>Implements <a class="el" href="classqrs_1_1AbsMessageSerializer.html#a123deb41c52c9fea04338f8bbc18a140">qrs::AbsMessageSerializer</a>.</p>

<p>Definition at line <a class="el" href="jsonserializer_8cpp_source.html#l00049">49</a> of file <a class="el" href="jsonserializer_8cpp_source.html">jsonserializer.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a62711f539347e689d2e8def70fde3f1c"></a><!-- doxytag: member="qrs::JsonSerializer::serialize" ref="a62711f539347e689d2e8def70fde3f1c" args="(const Message &amp;msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray JsonSerializer::serialize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classqrs_1_1Message.html">Message</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throw (<a class="el" href="classqrs_1_1UnsupportedTypeException.html">UnsupportedTypeException</a>)<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Serealize <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a>. <dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classqrs_1_1UnsupportedTypeException.html" title="Unsupported type exception.">UnsupportedTypeException</a></em>&nbsp;</td><td>if remote call object contain data which can't be converted to the underlying protocol message. For example Message::params contain parameters of types not supported by underlying protocol.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td><a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> class instance to be converted to a underlying protocol message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>raw underlying protocol message.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a123deb41c52c9fea04338f8bbc18a140" title="Deserealize Message.">deserialize</a> </dd></dl>
 </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>what to do if message type is incorrect? </dd></dl>
</p>

<p>Implements <a class="el" href="classqrs_1_1AbsMessageSerializer.html#a13461e3103e4110226ec17da52417410">qrs::AbsMessageSerializer</a>.</p>

<p>Definition at line <a class="el" href="jsonserializer_8cpp_source.html#l00028">28</a> of file <a class="el" href="jsonserializer_8cpp_source.html">jsonserializer.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="jsonserializer_8h_source.html">jsonserializer.h</a></li>
<li><a class="el" href="jsonserializer_8cpp_source.html">jsonserializer.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Aug 24 00:57:33 2010 for QRemoteSignal by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
