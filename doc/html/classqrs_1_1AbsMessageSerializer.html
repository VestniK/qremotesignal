<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>QRemoteSignal: qrs::AbsMessageSerializer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceqrs.html">qrs</a>::<a class="el" href="classqrs_1_1AbsMessageSerializer.html">AbsMessageSerializer</a>
  </div>
</div>
<div class="contents">
<h1>qrs::AbsMessageSerializer Class Reference</h1><!-- doxytag: class="qrs::AbsMessageSerializer" -->
<p>Abstrac tinterface for all remote call serializers.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="absmessageserializer_8h_source.html">absmessageserializer.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for qrs::AbsMessageSerializer:</div>
<div class="dynsection">
 <div class="center">
  <img src="classqrs_1_1AbsMessageSerializer.png" usemap="#qrs::AbsMessageSerializer_map" alt=""/>
  <map id="qrs::AbsMessageSerializer_map" name="qrs::AbsMessageSerializer_map">
<area href="classqrs_1_1JsonSerializer.html" alt="qrs::JsonSerializer" shape="rect" coords="0,56,164,80"/>
<area href="classqrs_1_1QDataStreamSerializer.html" alt="qrs::QDataStreamSerializer" shape="rect" coords="174,56,338,80"/>
</map>
 </div>
</div>

<p><a href="classqrs_1_1AbsMessageSerializer-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classqrs_1_1AbsMessageSerializer.html#af1f689583f594005d719b9eadef0a1fb">AbsMessageSerializer</a> (QObject *parent=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a2dde80ef2c0f33cf737ed73e44e67598">AbsMessageSerializer</a> (int version, QObject *parent=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a7dc0b692a0fbad367587715e24256fbf">version</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual QByteArray&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a13461e3103e4110226ec17da52417410">serialize</a> (const <a class="el" href="classqrs_1_1Message.html">Message</a> &amp;msg)=0  throw (UnsupportedTypeException)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Serealize <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a>.  <a href="#a13461e3103e4110226ec17da52417410"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual MessageAP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a123deb41c52c9fea04338f8bbc18a140">deserialize</a> (const QByteArray &amp;msg)=0  throw (MessageParsingException)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deserealize <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a>.  <a href="#a123deb41c52c9fea04338f8bbc18a140"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Abstrac tinterface for all remote call serializers. </p>
<p>Serializer must provide two functions: serialize and deserialize. First one converts instance of class <a class="el" href="classqrs_1_1Message.html" title="Message representation.">qrs::Message</a> (internal library message representation) to a raw underlying protocol message. The second one builds instance of <a class="el" href="classqrs_1_1Message.html" title="Message representation.">qrs::Message</a> from a raw protocol message. Instance created by the deserialize function from raw messagege returned by the serialize function should be equal to the initial instance.</p>
<p>When implementing this two function keep thread safety in mind. In this case you can use one single global instance of your serializer in all threads. By default all ServicesMessages use the same serializer instance. If you have implemented serializer which is not thread safe and want to use it in multythreaded application you should follow some rules in order to have no thread-safety issues: </p>
<ul>
<li>Use different <a class="el" href="classqrs_1_1ServicesManager.html" title="Class managing communications between services and clients.">ServicesManager</a> instances in different threads. </li>
<li>Do not set non-thread-safe serializer as default with <a class="el" href="classqrs_1_1ServicesManager.html#aa056b04d7552252ebba8fc53db831f9a">ServicesManager::setDefaultSerializer()</a> function. </li>
<li>Ensure that serializers from different threads use different instances of non-thread-safe serializer.</li>
</ul>
<p>There is a simple template class which helps to create and manage single global instance of serializer: <a class="el" href="classqrs_1_1GlobalSerializer.html" title="Singleton factory manages one instance of serializer.">qrs::GlobalSerializer</a>. Serializers which comes with the library itself uses this class to store global instace. It's done with macro like: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #define jsonSerializer qrs::GlobalSerializer&lt;qrs::JsonSerializer&gt;::instance()</span>
</pre></div><p> Common rule is name of macro is the same as class name but the first letter is lowercase. You can use the same approach when implementing your own serializers.</p>
<p>If you serializer supports several version of the underlying RPC protocol you can pass it as a second template parameter of the <a class="el" href="classqrs_1_1GlobalSerializer.html" title="Singleton factory manages one instance of serializer.">GlobalSerializer</a> class: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #define qDataStreamSerializer_4_5 qrs::GlobalSerializer&lt;qrs::QDataStreamSerializer,QDataStream::Qt_4_5&gt;::instance()</span>
</pre></div><p>Once you've created your own serializer you can test it to compatibility with this library using serializers test suit. You need to take 4 files from the tests/serializers directory of the sources package of QRemoteSignal library: </p>
<ul>
<li>messagetesttools.h </li>
<li>messagetesttools.cpp </li>
<li>serializerstestsuit.h </li>
<li>serializerstestsuit.cpp</li>
</ul>
<p>Then you need to create instance of <b>SerializersTestSuit</b> class passing to its constructor instance of you serializer class and run tests using <b>QTest::qExec</b> function. You can also use <b>addDeserializationErrorTestCase</b> method of the <b>SerializersTestSuit</b> class to test that your serializer throws <a class="el" href="classqrs_1_1MessageParsingException.html" title="Error during message parsing exception.">MessageParsingException</a> on attempt to deserialize some specific raw messages.</p>
<p>Here is example of main function for tests of the <a class="el" href="classqrs_1_1JsonSerializer.html" title="Message serializer for simple JSON based remote call protocol.">JsonSerializer</a> class which comes with this library: </p>
<div class="fragment"><pre class="fragment">
<span class="preprocessor">#include &lt;QtTest/QtTest&gt;</span>

<span class="preprocessor">#include &quot;serializerstestsuit.h&quot;</span>
<span class="preprocessor">#include &quot;<a class="code" href="jsonserializer_8h.html" title="JsonSerializer interface.">jsonserializer.h</a>&quot;</span>

<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {
   SerializersTestSuit testsuit(<a class="code" href="jsonserializer_8h.html#a55b6140140a6769814d8c879541f8922">jsonSerializer</a>);

   testsuit.addDeserializationErrorTestCase(<span class="stringliteral">&quot;NotJson&quot;</span>,(QByteArray)<span class="stringliteral">&quot;12345&quot;</span>);
   testsuit.addDeserializationErrorTestCase(<span class="stringliteral">&quot;EmptyMessage&quot;</span>,(QByteArray)<span class="stringliteral">&quot;{}&quot;</span>);
   testsuit.addDeserializationErrorTestCase(<span class="stringliteral">&quot;NoType&quot;</span>, (QByteArray)<span class="stringliteral">&quot;{\&quot;service\&quot;:\&quot;Example\&quot;,\&quot;method\&quot;:\&quot;voidMethod\&quot;}&quot;</span>);
   testsuit.addDeserializationErrorTestCase(<span class="stringliteral">&quot;WrongType&quot;</span>, (QByteArray)<span class="stringliteral">&quot;{\&quot;Wrong\&quot;:{\&quot;service\&quot;:\&quot;Example\&quot;,\&quot;method\&quot;:\&quot;voidMethod\&quot;}}&quot;</span>);

   <span class="keywordflow">return</span> QTest::qExec(&amp;testsuit,argc,argv);
}
</pre></div> 
<p>Definition at line <a class="el" href="absmessageserializer_8h_source.html#l00081">81</a> of file <a class="el" href="absmessageserializer_8h_source.html">absmessageserializer.h</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af1f689583f594005d719b9eadef0a1fb"></a><!-- doxytag: member="qrs::AbsMessageSerializer::AbsMessageSerializer" ref="af1f689583f594005d719b9eadef0a1fb" args="(QObject *parent=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qrs::AbsMessageSerializer::AbsMessageSerializer </td>
          <td>(</td>
          <td class="paramtype">QObject *&nbsp;</td>
          <td class="paramname"> <em>parent</em> = <code>0</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, explicit]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This constructor creates new instance with given parent. mVersion constant is set to 0. </p>

<p>Definition at line <a class="el" href="absmessageserializer_8h_source.html#l00025">25</a> of file <a class="el" href="absmessageserializer_8h_source.html">absmessageserializer.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2dde80ef2c0f33cf737ed73e44e67598"></a><!-- doxytag: member="qrs::AbsMessageSerializer::AbsMessageSerializer" ref="a2dde80ef2c0f33cf737ed73e44e67598" args="(int version, QObject *parent=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qrs::AbsMessageSerializer::AbsMessageSerializer </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QObject *&nbsp;</td>
          <td class="paramname"> <em>parent</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, explicit]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This constructor creates new instance with given parent. mVersion constant is set to version parameter value.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>mVersion </dd></dl>

<p>Definition at line <a class="el" href="absmessageserializer_8h_source.html#l00034">34</a> of file <a class="el" href="absmessageserializer_8h_source.html">absmessageserializer.h</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a123deb41c52c9fea04338f8bbc18a140"></a><!-- doxytag: member="qrs::AbsMessageSerializer::deserialize" ref="a123deb41c52c9fea04338f8bbc18a140" args="(const QByteArray &amp;msg)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual MessageAP qrs::AbsMessageSerializer::deserialize </td>
          <td>(</td>
          <td class="paramtype">const QByteArray &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throw (<a class="el" href="classqrs_1_1MessageParsingException.html">MessageParsingException</a>)<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deserealize <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a>. </p>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classqrs_1_1MessageParsingException.html" title="Error during message parsing exception.">MessageParsingException</a></em>&nbsp;</td><td>in case of error during message parsing</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>underlying protocol raw message to be converted to a <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> class instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> class instance</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a13461e3103e4110226ec17da52417410" title="Serealize Message.">serialize</a> </dd></dl>

<p>Implemented in <a class="el" href="classqrs_1_1JsonSerializer.html#ad813751af9ab056a482bbc3d5e7802a3">qrs::JsonSerializer</a>, and <a class="el" href="classqrs_1_1QDataStreamSerializer.html#abbfafb10d4da7f0e469878cc16b550aa">qrs::QDataStreamSerializer</a>.</p>

</div>
</div>
<a class="anchor" id="a13461e3103e4110226ec17da52417410"></a><!-- doxytag: member="qrs::AbsMessageSerializer::serialize" ref="a13461e3103e4110226ec17da52417410" args="(const Message &amp;msg)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual QByteArray qrs::AbsMessageSerializer::serialize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classqrs_1_1Message.html">Message</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throw (<a class="el" href="classqrs_1_1UnsupportedTypeException.html">UnsupportedTypeException</a>)<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Serealize <a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a>. </p>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classqrs_1_1UnsupportedTypeException.html" title="Unsupported type exception.">UnsupportedTypeException</a></em>&nbsp;</td><td>if remote call object contain data which can't be converted to the underlying protocol message. For example Message::params contain parameters of types not supported by underlying protocol.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td><a class="el" href="classqrs_1_1Message.html" title="Message representation.">Message</a> class instance to be converted to a underlying protocol message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>raw underlying protocol message.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classqrs_1_1AbsMessageSerializer.html#a123deb41c52c9fea04338f8bbc18a140" title="Deserealize Message.">deserialize</a> </dd></dl>

<p>Implemented in <a class="el" href="classqrs_1_1JsonSerializer.html#a62711f539347e689d2e8def70fde3f1c">qrs::JsonSerializer</a>, and <a class="el" href="classqrs_1_1QDataStreamSerializer.html#aff44d8f98a957f7ca5ab36c64164d693">qrs::QDataStreamSerializer</a>.</p>

</div>
</div>
<a class="anchor" id="a7dc0b692a0fbad367587715e24256fbf"></a><!-- doxytag: member="qrs::AbsMessageSerializer::version" ref="a7dc0b692a0fbad367587715e24256fbf" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qrs::AbsMessageSerializer::version </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>version of the protocol used by this serializer instance. </dd></dl>

<p>Definition at line <a class="el" href="absmessageserializer_8h_source.html#l00043">43</a> of file <a class="el" href="absmessageserializer_8h_source.html">absmessageserializer.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="absmessageserializer_8h_source.html">absmessageserializer.h</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Aug 24 01:35:25 2010 for QRemoteSignal by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
