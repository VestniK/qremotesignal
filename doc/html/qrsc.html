<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>QRemoteSignal: XML service description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">QRemoteSignal
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">XML service description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Slots you want to call remotely should be described in an XML file which will be used to generate C++ classes you can use in your application. One XML file describes one service (see <a class="el" href="services_concept.html">Services conception</a> for details about services).</p>
<h1><a class="anchor" id="schema"></a>
File format</h1>
<p>Here is a simple example of service XML description: </p>
<div class="fragment"><div class="line">&lt;service name=<span class="stringliteral">&quot;Example&quot;</span>&gt;</div>
<div class="line">   &lt;customtypes header=<span class="stringliteral">&quot;customtypesconverters.h&quot;</span>/&gt;</div>
<div class="line">   &lt;slot name=<span class="stringliteral">&quot;mySlot&quot;</span>&gt;</div>
<div class="line">      &lt;param name=<span class="stringliteral">&quot;num&quot;</span> type=<span class="stringliteral">&quot;qint32&quot;</span>/&gt;</div>
<div class="line">   &lt;/slot&gt;</div>
<div class="line">   &lt;signal name=<span class="stringliteral">&quot;mySignal&quot;</span>&gt;</div>
<div class="line">      &lt;param name=<span class="stringliteral">&quot;str&quot;</span> type=<span class="stringliteral">&quot;QString&quot;</span>/&gt;</div>
<div class="line">   &lt;/signal&gt;</div>
<div class="line">&lt;/service&gt;</div>
</div><!-- fragment --><ul>
<li>Root element <b>service</b> must have <b>name</b> attribute with a service name.</li>
</ul>
<ul>
<li>You can have any number of <b>customtypes</b> elements with <b>header</b> attribute specifying C++ header file with convertors functions for your custom types (see <a class="el" href="converters.html">Types that can be used as remote callable slots arguments</a> for details). This header is included in the *.h files with the interface of the service and cient classes.</li>
</ul>
<ul>
<li><b>slot</b> element describes slot which can be called remotelly. Attribute <b>name</b> specifies the name of this slot. This element can have any number of child <b>param</b> elements.</li>
</ul>
<ul>
<li><b>signal</b> element describes signal which can be emited to remote application. Attribute <b>name</b> specifies the name of this signal. This element can have any number of child <b>param</b> elements.</li>
</ul>
<ul>
<li><b>param</b> element is used inside <b>signal</b> and <b>slot</b> elements to describe signal or slot parameter. It has two attributes <b>type</b> which specifies C++ type of the corresponding signal or slot argument and <b>name</b> which specifies parameter name. Both of this attributes are obligitary.</li>
</ul>
<h1><a class="anchor" id="code_generation"></a>
C++ code generation with qrsc utility</h1>
<p>Once you've described your application remote interface in XML files you can generate classes which you can use in your application. You can do this with <b>qrsc</b> application (qrsc is abbriviation for QRemoteSignal compiler).</p>
<p>To generate a <em>Sevice</em> class (the one to be used in a server application) use the following command: </p>
<div class="fragment"><div class="line">qrsc --service --header exampleservice.h --source exampleservice.cpp example.xml</div>
</div><!-- fragment --><p> it will create two files <b>exampleservice.h</b> and <b>exampleservice.cpp</b> with declaration and implementation of class describing your service.</p>
<p>To generate a <em>Client</em> class (the one to be use in a client application) use the following command: </p>
<div class="fragment"><div class="line">qrsc --client --header exampleclient.h --source exampleclient.cpp example.xml</div>
</div><!-- fragment --><p> it will create two files <b>exampleclient.h</b> and <b>exampleclient.cpp</b> with declaration and implementation of class describing interface for calling your service slots and reciving its signals from the client application.</p>
<p>You can find more information about <b>qrsc</b> in its unix man page or by running </p>
<div class="fragment"><div class="line">qrsc --help</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>If you have interface files for the version 0.6.0 of the QRemoteSignal library or older you should rename all <b>method</b> elements to <b>slot</b> or run <div class="fragment"><div class="line">qrsc --update old_file.xml new_file.xml</div>
</div><!-- fragment --> to do it automatically. You still can use your old interface with the new version of <b>qrsc</b> utility but it will print warning message about outdated format of your service.</dd></dl>
<h1><a class="anchor" id="generated_classes"></a>
Using generated classes in your application</h1>
<p>Classes generated from XML interface description can be used to call slots and emit signals between different application.</p>
<p>First of all you need to register instances of generated class in a <a class="el" href="classqrs_1_1ServicesManager.html" title="Class managing communications between services and clients. ">qrs::ServicesManager</a> class instance (see this class documentation for detales). After your service or client class is registered in manager you can connect signals and slots it has to you application classes signals and slots. Each time you call a slot in generated class services manager sends a message to another application to call corresponding signal in it.</p>
<h2><a class="anchor" id="generated_service"></a>
Using generated class in the server application.</h2>
<p>Here is public signals and slots of the service class generated from the example XML file you can find in the beggining of this page: </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>qrs {</div>
<div class="line"></div>
<div class="line">   <span class="keyword">class </span>ExampleService: <span class="keyword">public</span> AbsService {</div>
<div class="line">      ...</div>
<div class="line">      <span class="keyword">public</span> slots:</div>
<div class="line">         <span class="keywordtype">void</span> mySignal(<span class="keyword">const</span> QString &amp;str);</div>
<div class="line">      signals:</div>
<div class="line">         <span class="keywordtype">void</span> mySlot(<span class="keyword">const</span> quint32 &amp;num);</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --><p>Each time you server receives request to call slot <b>mySlot</b> instance of this class emits signal <b>mySlot</b> you can connect it to any slot in you application to provide meaningfull reaction on this event.</p>
<p>Each time you want your server to emit remote signal <b>mySignal</b> you need to call <b>mySignal</b> slot and you server sends request to the client application to call necessary function.</p>
<h2><a class="anchor" id="generated_client"></a>
Using generated class in the client application.</h2>
<p>Here is public signals and slots of the client class generated from the example XML file you can find in the beggining of this page: </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>qrs {</div>
<div class="line"></div>
<div class="line">   <span class="keyword">class </span>ExampleClient: <span class="keyword">public</span> AbsService {</div>
<div class="line">      ...</div>
<div class="line">      <span class="keyword">public</span> slots:</div>
<div class="line">         <span class="keywordtype">void</span> mySlot(<span class="keyword">const</span> quint32 &amp;num);</div>
<div class="line">      signals:</div>
<div class="line">         <span class="keywordtype">void</span> mySignal(<span class="keyword">const</span> QString &amp;str);</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --><p>Each time you call slot <b>mySlot</b> you client application sends to your server application request to call corresponding function.</p>
<p>Each time your server application sends signal <b>mySignal</b> to you client application signal <b>mySignal</b> is emitted. You can connect this signal to some slot in your class to provide meaningfull reaction on this event.</p>
<h1><a class="anchor" id="build_systems"></a>
How to invoke qrsc from different build systems</h1>
<p>You can invoke <b>qrsc</b> manually each time your XML service description is updated or new one added but it's better to do this from your build system scrits. Here are some tips how to run <b>qrsc</b> from different buildsystems.</p>
<h2><a class="anchor" id="scons"></a>
scons</h2>
<p>You can find scons tool to invoke <b>qrsc</b> from scons in the <em>site_scons/site_tools/qrsc.py</em> file of the library distribution. Just use it in you project.</p>
<dl class="section note"><dt>Note</dt><dd>This tool depends on qt4 tool which you can find in this library distribution or download from the official project repository. See project home page: <a href="http://www.iua.upf.edu/~dgarcia/Codders/sconstools.html">http://www.iua.upf.edu/~dgarcia/Codders/sconstools.html</a></dd></dl>
<p>This tool provides two builders </p>
<ul>
<li>QRSService which creates services classes from XML service descritptions and returns list of C++ sources files. </li>
<li>QRSClient which creates clients classes from XML service descritptions and returns list of C++ sources files.</li>
</ul>
<p>Here is example how to use them in your SConstruct: </p>
<div class="fragment"><div class="line">env = Environment()</div>
<div class="line">env.Tool(&#39;qt4&#39;)</div>
<div class="line">env.Tool(&#39;qrs&#39;)</div>
<div class="line"></div>
<div class="line">env.EnableQt4Modules([&#39;QtCore&#39;])</div>
<div class="line"></div>
<div class="line">ServerSources=[&#39;server.cpp&#39;]</div>
<div class="line">ServerSources += env.QRSService(&#39;service.xml&#39;)</div>
<div class="line"></div>
<div class="line">ClientSources=[&#39;client.cpp&#39;]</div>
<div class="line">ClientSources += env.QRSClient(&#39;service.xml&#39;)</div>
<div class="line"></div>
<div class="line">env.Program(&#39;server&#39;,ServerSources)</div>
<div class="line">env.Program(&#39;client&#39;,ClientSources)</div>
</div><!-- fragment --><h2><a class="anchor" id="cmake"></a>
cmake</h2>
<p>This version of QRemoteSignal library comes with CMake config file with macroses to invoke <b>qrsc</b> during build. This file is installed to the <code>${prefix_lib}/cmake/QRemoteSignal</code> directory. If you haven't specified <b>prefix_lib</b> variable during building QRemoteSignal its value is <code>${prefix}/lib</code> where <b>${prefix}</b> is library installation path.</p>
<p>If you want to use QRemoteSignal library in a project which is using CMake as build system you can simply use find_package macro. After that two new macroses will be available: <b>qrs_wrap_client</b> and <b>qrs_wrap_service</b>.</p>
<ul>
<li><b>qrs_wrap_client(DEST_VAR SERVICES)</b> macro adds target which generates Client classes with <b>qrsc</b> for every file in the SERVICES list and then invokes Qt4 <b>moc</b> utility on each produced C++ header file. List of all generated C++ sources is added to the DEST_VAR output parameter. </li>
<li><b>qrs_wrap_service(DEST_VAR SERVICES)</b> macro adds target which generates Service classes with <b>qrsc</b> for every file in the SERVICES list and then invokes Qt4 <b>moc</b> utility on each produced C++ header file. List of all generated C++ sources is added to the DEST_VAR output parameter.</li>
</ul>
<p>Here is simple example of <b>CMakeLists.txt</b> file for project using QRemoteSignal library: </p>
<div class="fragment"><div class="line"><span class="preprocessor"># According to CMake documentation minimum cmake version which looks</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># for CMake config files in the ${prefix}/lib/cmake/${PackageName}*</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># dirictories is 2.6.3</span></div>
<div class="line"><span class="preprocessor"></span>cmake_minimum_required(VERSION 2.6.3)</div>
<div class="line">project(CMakeExample)</div>
<div class="line"></div>
<div class="line">find_package(Qt4 4.5.0 COMPONENTS QtCore QtNetwork REQUIRED)</div>
<div class="line">find_package(QRemoteSignal REQUIRED)</div>
<div class="line">include(${QT_USE_FILE})</div>
<div class="line">include_directories(${QRemoteSignal_INCLUDE_DIR})</div>
<div class="line"></div>
<div class="line">set(SERVER_SRC server.cpp)</div>
<div class="line">set(CLIENT_SRC client.cpp)</div>
<div class="line">set(SERVICES service.xml)</div>
<div class="line"></div>
<div class="line">qrs_wrap_service(SERVER_SERVICES_SRC ${SERVICES})</div>
<div class="line">qrs_wrap_client(CLIENT_SERVICES_SRC ${SERVICES})</div>
<div class="line">include_directories(${CMAKE_CURRENT_BINARY_DIR})</div>
<div class="line"></div>
<div class="line">add_executable(server ${SERVER_SRC} ${SERVER_SERVICES_SRC})</div>
<div class="line">target_link_libraries(server ${QT_LIBRARIES} ${QRemoteSignal_LIBRARY})</div>
<div class="line"></div>
<div class="line">add_executable(client ${CLIENT_SRC} ${CLIENT_SERVICES_SRC})</div>
<div class="line">target_link_libraries(client ${QT_LIBRARIES} ${QRemoteSignal_LIBRARY})</div>
</div><!-- fragment --><h2><a class="anchor" id="qmake"></a>
qmake</h2>
<p>This version of QRemoteSignal library comes with qmake custom feature file. You can find it in the library installation directory its name is <b>qremotesignal.prf</b>. First of all you need to enshure that the directory containig this file is searched by qmake for configuration features. The simpliest way to do it is to add this directory path to the <b>QMAKEFEATURES</b> envirunment variable. If library was installed with <b>prefix_qmake_feature=GLOBAL</b> option then feature file is added to the standart Qt4 features search directory.</p>
<p>After that you can use this feature in you qmake projects. Use <b>QRS_SERVICE_INTERFACES</b> variable in you project file to specify which XML file should be used to generate servces classes. Use <b>QRS_CLIENT_INTERFACES</b> variable to specify which XML files should be used to generate client classes.</p>
<p>Here is example of this feature ussage: </p>
<ul>
<li>server.pro <div class="fragment"><div class="line">TEMPLATE = app</div>
<div class="line">TARGET = server</div>
<div class="line"></div>
<div class="line">SOURCES = server.cpp</div>
<div class="line">QRS_SERVICE_INTERFACES = service.xml</div>
<div class="line"></div>
<div class="line">CONFIG += qremotesignal</div>
</div><!-- fragment --> </li>
<li>client.pro <div class="fragment"><div class="line">TEMPLATE = app</div>
<div class="line">TARGET = client</div>
<div class="line"></div>
<div class="line">SOURCES = client.cpp</div>
<div class="line">QRS_CLIENT_INTERFACES = service.xml</div>
<div class="line"></div>
<div class="line">CONFIG += qremotesignal</div>
</div><!-- fragment --> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 7 2013 01:26:57 for QRemoteSignal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
